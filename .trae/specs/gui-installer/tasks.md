# 任务列表：GUI可视化界面与一键安装包

## 概述

为 PPT Translator 创建一个现代化的图形用户界面（GUI），并将其打包为 Windows 一键安装程序，让非技术用户也能轻松使用。

---

## Phase 1: 项目准备与环境搭建

### 任务 1.1: 创建项目结构
**描述**: 创建 GUI 模块和构建脚本的目录结构
**验收标准**:
- [ ] 创建 `gui/` 目录及其子目录
- [ ] 创建 `build/` 目录
- [ ] 创建 `assets/` 目录存放图标和资源

**依赖**: 无
**预计工时**: 0.5 小时

### 任务 1.2: 安装依赖库
**描述**: 安装 GUI 开发和打包所需的 Python 库
**验收标准**:
- [ ] 安装 `customtkinter>=5.2`
- [ ] 安装 `pyinstaller>=6.0`
- [ ] 更新 `requirements.txt` 添加新依赖

**依赖**: 任务 1.1
**预计工时**: 0.5 小时

---

## Phase 2: GUI 核心组件开发

### 任务 2.1: 主题与样式管理器
**描述**: 创建主题管理器，支持深色/浅色模式
**验收标准**:
- [ ] 实现 `ThemeManager` 类
- [ ] 定义颜色方案和字体规范
- [ ] 支持运行时主题切换
- [ ] 保存用户主题偏好到配置文件

**依赖**: 任务 1.2
**预计工时**: 4 小时

### 任务 2.2: 配置管理器
**描述**: 创建配置管理器，保存和加载用户设置
**验收标准**:
- [ ] 实现 `ConfigManager` 类
- [ ] 支持 API 密钥加密存储
- [ ] 默认配置项：语言偏好、默认提供商、窗口大小
- [ ] 配置文件存储在 `%APPDATA%/PPTTranslator/`

**依赖**: 任务 2.1
**预计工时**: 3 小时

### 任务 2.3: 文件选择组件
**描述**: 创建文件选择组件，支持文件和文件夹选择
**验收标准**:
- [ ] 实现 `FileSelector` 类
- [ ] 支持单文件选择（.pptx 过滤）
- [ ] 支持多文件选择
- [ ] 支持文件夹选择（递归选项）
- [ ] 显示已选择文件列表，支持删除单个项
- [ ] 拖放文件支持（可选）

**依赖**: 任务 2.2
**预计工时**: 4 小时

### 任务 2.4: 提供商选择组件
**描述**: 创建翻译提供商选择和配置组件
**验收标准**:
- [ ] 实现 `ProviderSelector` 类
- [ ] 下拉列表显示所有可用提供商
- [ ] 根据选择动态显示对应配置项
- [ ] API 密钥输入框（密码掩码）
- [ ] "验证"按钮测试 API 连接
- [ ] 显示提供商说明和模型信息
- [ ] 语言对选择（源语言 → 目标语言）

**依赖**: 任务 2.3
**预计工时**: 5 小时

### 任务 2.5: 进度显示组件
**描述**: 创建进度条和状态显示组件
**验收标准**:
- [ ] 实现 `ProgressDisplay` 类
- [ ] 总体进度条（百分比显示）
- [ ] 当前操作文字描述
- [ ] 文件计数（第 X/Y 个文件）
- [ ] 预计剩余时间（可选）
- [ ] 实时日志显示区域（滚动）
- [ ] 取消按钮（可中断操作）

**依赖**: 任务 2.4
**预计工时**: 3 小时

---

## Phase 3: 对话框与辅助功能

### 任务 3.1: 设置对话框
**描述**: 创建设置对话框，管理应用配置
**验收标准**:
- [ ] 实现 `SettingsDialog` 类
- [ ] 常规设置：主题、语言、自动更新
- [ ] 翻译设置：默认提供商、默认语言对
- [ ] 高级设置：线程数、分块大小、输出目录
- [ ] 重置为默认值按钮
- [ ] 应用/取消按钮

**依赖**: 任务 2.5
**预计工时**: 4 小时

### 任务 3.2: API 密钥管理对话框
**描述**: 创建专门的 API 密钥管理界面
**验收标准**:
- [ ] 实现 `ApiKeyDialog` 类
- [ ] 表格显示所有已配置的提供商
- [ ] 添加/编辑/删除密钥功能
- [ ] 密钥显示/隐藏切换
- [ ] 密钥加密存储（使用 Windows DPAPI）
- [ ] 测试所有密钥按钮
- [ ] 批量导入/导出（可选）

**依赖**: 任务 3.1
**预计工时**: 5 小时

### 任务 3.3: 关于对话框
**描述**: 创建关于对话框，显示应用信息
**验收标准**:
- [ ] 实现 `AboutDialog` 类
- [ ] 应用图标和名称
- [ ] 版本号、构建日期
- [ ] 版权声明和许可信息
- [ ] 致谢列表（第三方库）
- [ ] 检查更新按钮
- [ ] 项目主页链接

**依赖**: 任务 3.2
**预计工时**: 2 小时

### 任务 3.4: 结果展示对话框
**描述**: 创建翻译结果展示对话框
**验收标准**:
- [ ] 实现 `ResultDialog` 类
- [ ] 成功状态：显示输出文件路径
- [ ] 打开文件按钮
- [ ] 打开所在文件夹按钮
- [ ] 失败状态：显示错误详情
- [ ] 重试按钮
- [ ] 批量结果表格（文件名、状态、输出路径）
- [ ] 导出结果报告按钮

**依赖**: 任务 3.3
**预计工时**: 3 小时

---

## Phase 4: 主窗口与集成

### 任务 4.1: 主窗口框架
**描述**: 创建主应用程序窗口
**验收标准**:
- [ ] 实现 `MainWindow` 类
- [ ] 窗口标题和图标
- [ ] 最小尺寸限制（900x650）
- [ ] 菜单栏（文件、编辑、视图、帮助）
- [ ] 工具栏（快捷按钮）
- [ ] 状态栏（状态信息、进度）
- [ ] 记住窗口位置和大小

**依赖**: 任务 3.4
**预计工时**: 4 小时

### 任务 4.2: 工作流集成
**描述**: 将各个组件集成为完整的工作流
**验收标准**:
- [ ] 文件选择 → 翻译设置 → 开始按钮 流程
- [ ] 输入验证（文件存在、API 密钥有效）
- [ ] 翻译过程调度和监控
- [ ] 实时进度更新到 UI
- [ ] 结果展示和后续操作
- [ ] 错误处理和恢复机制
- [ ] 取消操作支持

**依赖**: 任务 4.1
**预计工时**: 6 小时

### 任务 4.3: 首次启动向导
**描述**: 创建首次启动向导，帮助用户配置
**验收标准**:
- [ ] 实现 `FirstRunWizard` 类
- [ ] 欢迎页面
- [ ] API 密钥配置步骤
- [ ] 默认偏好设置
- [ ] 完成页面
- [ ] 跳过/稍后设置选项
- [ ] 只在首次启动显示

**依赖**: 任务 4.2
**预计工时**: 3 小时

---

## Phase 5: 打包与分发

### 任务 5.1: 创建 PyInstaller 构建脚本
**描述**: 编写 PyInstaller 构建配置
**验收标准**:
- [ ] 创建 `build/build_exe.py` 脚本
- [ ] 配置单文件模式
- [ ] 包含所有依赖和数据文件
- [ ] 设置图标和元数据
- [ ] 使用 UPX 压缩
- [ ] 排除测试和开发依赖
- [ ] 生成版本信息文件

**依赖**: 任务 4.3
**预计工时**: 3 小时

### 任务 5.2: 创建 Inno Setup 安装脚本
**描述**: 编写 Inno Setup 安装程序配置
**验收标准**:
- [ ] 创建 `build/setup.iss` 脚本
- [ ] 配置应用元数据
- [ ] 设置安装目录和快捷方式
- [ ] 包含所有必要文件
- [ ] 配置卸载程序
- [ ] 添加安装向导页面
- [ ] 支持静默安装参数

**依赖**: 任务 5.1
**预计工时**: 2 小时

### 任务 5.3: 创建一键构建脚本
**描述**: 创建自动化构建流程
**验收标准**:
- [ ] 创建 `build.py` 一键构建脚本
- [ ] 清理旧的构建文件
- [ ] 运行 PyInstaller 构建
- [ ] 复制资源文件到输出目录
- [ ] 运行 Inno Setup 创建安装包
- [ ] 验证输出文件完整性
- [ ] 显示构建结果摘要

**依赖**: 任务 5.2
**预计工时**: 2 小时

### 任务 5.4: 创建安装说明文档
**描述**: 编写用户安装和使用指南
**验收标准**:
- [ ] 创建 `docs/INSTALL.md` 安装说明
- [ ] 系统要求说明
- [ ] 安装步骤截图
- [ ] 首次配置向导
- [ ] 常见问题解答
- [ ] 卸载说明

**依赖**: 任务 5.3
**预计工时**: 1 小时

---

## Phase 6: 测试与优化

### 任务 6.1: 功能测试
**描述**: 全面测试所有功能
**验收标准**:
- [ ] 文件选择功能测试（单个、多个、文件夹）
- [ ] 提供商配置测试（所有提供商）
- [ ] 翻译流程端到端测试
- [ ] 进度显示和取消功能测试
- [ ] 错误处理测试（无效文件、网络错误等）
- [ ] 设置保存和加载测试
- [ ] 首次启动向导测试

**依赖**: 任务 5.4
**预计工时**: 4 小时

### 任务 6.2: 兼容性测试
**描述**: 测试不同环境下的兼容性
**验收标准**:
- [ ] Windows 10 测试
- [ ] Windows 11 测试
- [ ] 不同分辨率适配测试
- [ ] 高 DPI 显示测试
- [ ] 杀毒软件兼容性测试
- [ ] 不同用户权限测试（管理员/普通用户）

**依赖**: 任务 6.1
**预计工时**: 3 小时

### 任务 6.3: 性能优化
**描述**: 优化性能和资源占用
**验收标准**:
- [ ] 启动时间优化（< 3 秒）
- [ ] 内存占用优化（< 200MB）
- [ ] 安装包体积优化（< 200MB）
- [ ] 大文件列表处理优化
- [ ] 界面响应速度优化

**依赖**: 任务 6.2
**预计工时**: 3 小时

### 任务 6.4: 最终验证
**描述**: 最终验证和发布准备
**验收标准**:
- [ ] 完整的安装/卸载流程测试
- [ ] 文档完整性检查
- [ ] 版本号和信息核对
- [ ] 最终构建验证
- [ ] 发布清单确认

**依赖**: 任务 6.3
**预计工时**: 2 小时

---

## 总结

### 任务统计

| Phase | 任务数 | 预计工时 |
|-------|--------|----------|
| Phase 1: 项目准备 | 2 | 1 小时 |
| Phase 2: GUI 核心组件 | 6 | 24 小时 |
| Phase 3: 对话框与辅助功能 | 4 | 14 小时 |
| Phase 4: 主窗口与集成 | 3 | 13 小时 |
| Phase 5: 打包与分发 | 4 | 8 小时 |
| Phase 6: 测试与优化 | 4 | 12 小时 |
| **总计** | **27** | **约 85 小时** |

### 关键里程碑

1. **M1 - GUI 原型完成** (Phase 2 结束)
   - 所有界面组件开发完成
   - 基础交互功能可用

2. **M2 - 功能集成完成** (Phase 4 结束)
   - 完整工作流程可用
   - 首次启动向导可用

3. **M3 - 安装包完成** (Phase 5 结束)
   - 一键安装程序可用
   - 完整安装/卸载流程可用

4. **M4 - 发布就绪** (Phase 6 结束)
   - 所有测试通过
   - 文档完整
   - 可正式发布

---

*本文档由 PPT Translator GUI 项目团队维护*
*最后更新: 2026-02-14*
