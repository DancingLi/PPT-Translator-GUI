# 检查清单：GUI可视化界面与一键安装包

本文档用于跟踪 GUI 界面和安装包开发的完成状态，确保所有功能按规格实现。

---

## 1. 项目结构与基础环境

### 1.1 目录结构
- [ ] `gui/` 目录创建
- [ ] `gui/widgets/` 子目录创建
- [ ] `gui/dialogs/` 子目录创建
- [ ] `gui/utils/` 子目录创建
- [ ] `build/` 目录创建
- [ ] `build/assets/` 子目录创建
- [ ] `docs/` 目录创建

### 1.2 依赖安装
- [ ] `customtkinter>=5.2` 已安装
- [ ] `pyinstaller>=6.0` 已安装
- [ ] `pillow` 已安装（如未安装）
- [ ] `requirements.txt` 已更新
- [ ] 测试导入成功

---

## 2. GUI 核心组件

### 2.1 主题管理器 (ThemeManager)
- [ ] `ThemeManager` 类已实现
- [ ] 支持深色主题颜色方案
- [ ] 支持浅色主题颜色方案（可选）
- [ ] 运行时主题切换功能
- [ ] 颜色常量定义完整

### 2.2 配置管理器 (ConfigManager)
- [ ] `ConfigManager` 类已实现
- [ ] JSON 配置文件读写
- [ ] API 密钥加密存储（Windows DPAPI）
- [ ] 默认配置项定义
- [ ] 配置验证功能
- [ ] 配置路径：`%APPDATA%/PPTTranslator/config.json`

### 2.3 文件选择组件 (FileSelector)
- [ ] `FileSelector` 类已实现
- [ ] 单个文件选择按钮
- [ ] 多文件选择按钮
- [ ] 文件夹选择按钮
- [ ] 已选择文件列表显示
- [ ] 删除单个文件功能
- [ ] 清空全部功能
- [ ] 文件类型过滤（.pptx）
- [ ] 拖放支持（可选）

### 2.4 提供商选择组件 (ProviderSelector)
- [ ] `ProviderSelector` 类已实现
- [ ] 提供商下拉列表
- [ ] 动态显示提供商配置项
- [ ] API 密钥输入框（密码显示/隐藏切换）
- [ ] "验证"按钮及验证逻辑
- [ ] 提供商说明和模型信息显示
- [ ] 源语言选择下拉框
- [ ] 目标语言选择下拉框
- [ ] 语言对兼容性检查

### 2.5 进度显示组件 (ProgressDisplay)
- [ ] `ProgressDisplay` 类已实现
- [ ] 总体进度条（百分比）
- [ ] 当前操作文字描述
- [ ] 文件计数显示（第 X/Y 个文件）
- [ ] 预计剩余时间显示（可选）
- [ ] 实时日志显示区域（带滚动）
- [ ] 取消按钮（可中断操作）
- [ ] 完成状态显示

---

## 3. 对话框

### 3.1 设置对话框 (SettingsDialog)
- [ ] `SettingsDialog` 类已实现
- [ ] 常规设置标签页：主题、语言、自动更新
- [ ] 翻译设置标签页：默认提供商、默认语言对
- [ ] 高级设置标签页：线程数、分块大小、输出目录
- [ ] 重置为默认值按钮
- [ ] 应用按钮（立即生效）
- [ ] 确定/取消按钮

### 3.2 API 密钥管理对话框 (ApiKeyDialog)
- [ ] `ApiKeyDialog` 类已实现
- [ ] 表格显示所有已配置的提供商
- [ ] 添加新密钥按钮
- [ ] 编辑现有密钥按钮
- [ ] 删除密钥按钮
- [ ] 显示/隐藏密钥切换
- [ ] 测试所有密钥按钮
- [ ] 密钥加密存储验证
- [ ] 批量导入/导出功能（可选）

### 3.3 关于对话框 (AboutDialog)
- [ ] `AboutDialog` 类已实现
- [ ] 应用图标和名称
- [ ] 版本号显示
- [ ] 构建日期
- [ ] 版权声明
- [ ] MIT 许可证全文或链接
- [ ] 致谢列表（第三方库）
- [ ] 检查更新按钮
- [ ] 项目主页链接

### 3.4 结果展示对话框 (ResultDialog)
- [ ] `ResultDialog` 类已实现
- [ ] 成功状态显示（绿色图标）
- [ ] 失败状态显示（红色图标）
- [ ] 输出文件路径显示
- [ ] 打开文件按钮
- [ ] 打开所在文件夹按钮
- [ ] 错误详情显示（失败时）
- [ ] 重试按钮（失败时）
- [ ] 批量结果表格（文件名、状态、输出路径）
- [ ] 导出结果报告按钮

---

## 4. 主窗口与工作流

### 4.1 主窗口框架
**描述**: 创建主应用程序窗口，整合所有组件
**验收标准**:
- [ ] `MainWindow` 类已实现
- [ ] 窗口标题和图标设置
- [ ] 最小尺寸限制（900x650）
- [ ] 菜单栏：文件、编辑、视图、帮助
- [ ] 工具栏（快捷按钮）：新建、打开、设置、帮助
- [ ] 状态栏：状态信息、进度指示
- [ ] 主内容区域布局
- [ ] 记住窗口位置和大小（关闭时保存）

**依赖**: 任务 3.4
**预计工时**: 6 小时

### 任务 4.2: 工作流集成
**描述**: 将各个组件集成为完整的工作流程
**验收标准**:
- [ ] 文件选择 → 翻译设置 → 开始按钮 流程连接
- [ ] 输入验证（文件存在、API 密钥有效）
- [ ] 调用后台翻译进程
- [ ] 实时进度更新到 UI
- [ ] 翻译完成结果显示
- [ ] 错误处理和恢复机制
- [ ] 取消操作支持（中断翻译）
- [ ] 日志记录到文件

**依赖**: 任务 4.1
**预计工时**: 8 小时

### 任务 4.3: 首次启动向导
**描述**: 创建首次启动向导，帮助用户快速配置
**验收标准**:
- [ ] `FirstRunWizard` 类已实现
- [ ] 欢迎页面（应用介绍）
- [ ] API 密钥配置步骤（至少一个提供商）
- [ ] 默认偏好设置步骤
- [ ] 完成页面（开始使用）
- [ ] 跳过/稍后设置选项
- [ ] 检测首次启动并自动显示
- [ ] 记住向导已完成状态

**依赖**: 任务 4.2
**预计工时**: 5 小时

---

## 5. 打包与分发

### 任务 5.1: 创建 PyInstaller 构建脚本
**描述**: 编写 PyInstaller 构建配置
**验收标准**:
- [ ] 创建 `build/build_exe.py` 脚本
- [ ] 配置单文件模式（--onefile）
- [ ] 配置无控制台窗口（--windowed）
- [ ] 包含所有数据文件和依赖
- [ ] 设置应用程序图标
- [ ] 添加版本信息和元数据
- [ ] 使用 UPX 压缩
- [ ] 测试构建过程

**依赖**: 任务 4.3
**预计工时**: 4 小时

### 任务 5.2: 创建 Inno Setup 安装脚本
**描述**: 编写 Inno Setup 安装程序配置
**验收标准**:
- [ ] 创建 `build/setup.iss` 脚本
- [ ] 配置应用名称、版本、发布者
- [ ] 设置默认安装目录
- [ ] 包含所有程序文件和资源
- [ ] 创建开始菜单快捷方式
- [ ] 创建桌面快捷方式（可选）
- [ ] 配置卸载程序
- [ ] 添加安装向导页面
- [ ] 测试安装和卸载流程

**依赖**: 任务 5.1
**预计工时**: 3 小时

### 任务 5.3: 创建一键构建脚本
**描述**: 创建自动化构建流程
**验收标准**:
- [ ] 创建 `build.py` 一键构建脚本
- [ ] 清理旧的构建文件
- [ ] 验证环境（Python、依赖）
- [ ] 运行 PyInstaller 构建
- [ ] 复制资源文件到输出目录
- [ ] 运行 Inno Setup 创建安装包
- [ ] 验证输出文件完整性
- [ ] 显示构建结果摘要（文件大小、路径）
- [ ] 错误处理和日志记录

**依赖**: 任务 5.2
**预计工时**: 3 小时

### 任务 5.4: 创建安装说明文档
**描述**: 编写用户安装和使用指南
**验收标准**:
- [ ] 创建 `docs/INSTALL.md` 安装说明
- [ ] 系统要求（Windows 版本、硬件配置）
- [ ] 下载安装包说明
- [ ] 安装步骤截图
- [ ] 首次启动配置向导说明
- [ ] 常见问题解答（FAQ）
- [ ] 卸载说明
- [ ] 更新/升级说明

**依赖**: 任务 5.3
**预计工时**: 2 小时

---

## 6. 测试与验证

### 任务 6.1: 功能测试
**描述**: 全面测试所有功能
**验收标准**:
- [ ] 文件选择功能测试（单个、多个、文件夹）
- [ ] 提供商配置测试（所有提供商）
- [ ] 翻译流程端到端测试
- [ ] 进度显示和取消功能测试
- [ ] 错误处理测试（无效文件、网络错误等）
- [ ] 设置保存和加载测试
- [ ] 首次启动向导测试
- [ ] 记录并修复所有发现的问题

**依赖**: 任务 5.4
**预计工时**: 6 小时

### 任务 6.2: 兼容性测试
**描述**: 测试不同环境下的兼容性
**验收标准**:
- [ ] Windows 10 测试（至少一个版本）
- [ ] Windows 11 测试
- [ ] 不同分辨率适配测试（1920x1080, 1366x768, 2560x1440）
- [ ] 高 DPI 显示测试（125%, 150%, 200% 缩放）
- [ ] 杀毒软件兼容性测试（Windows Defender, 360等）
- [ ] 不同用户权限测试（管理员/普通用户）
- [ ] 记录并修复所有兼容性问题

**依赖**: 任务 6.1
**预计工时**: 4 小时

### 任务 6.3: 性能优化
**描述**: 优化性能和资源占用
**验收标准**:
- [ ] 启动时间优化（目标：< 3 秒）
- [ ] 内存占用优化（目标：< 200MB）
- [ ] 安装包体积优化（目标：< 200MB）
- [ ] 大文件列表处理优化（>100 个文件）
- [ ] 界面响应速度优化（无卡顿）
- [ ] 性能测试和基线记录

**依赖**: 任务 6.2
**预计工时**: 4 小时

### 任务 6.4: 最终验证
**描述**: 最终验证和发布准备
**验收标准**:
- [ ] 完整的安装/卸载流程测试
- [ ] 文档完整性检查（README、INSTALL、CHANGELOG）
- [ ] 版本号和信息核对（v1.0.0）
- [ ] 最终构建验证（安装包可正常安装运行）
- [ ] 发布清单确认（所有交付物）
- [ ] 准备发布说明和发布公告

**依赖**: 任务 6.3
**预计工时**: 2 小时

---

## 任务依赖关系图

```
Phase 1: 项目准备
├── 任务 1.1: 创建项目结构
└── 任务 1.2: 安装依赖库
    ↓
Phase 2: GUI 核心组件
├── 任务 2.1: 主题与样式管理器
├── 任务 2.2: 配置管理器
├── 任务 2.3: 文件选择组件
├── 任务 2.4: 提供商选择组件
└── 任务 2.5: 进度显示组件
    ↓
Phase 3: 对话框与辅助功能
├── 任务 3.1: 设置对话框
├── 任务 3.2: API 密钥管理对话框
├── 任务 3.3: 关于对话框
└── 任务 3.4: 结果展示对话框
    ↓
Phase 4: 主窗口与工作流
├── 任务 4.1: 主窗口框架
├── 任务 4.2: 工作流集成
└── 任务 4.3: 首次启动向导
    ↓
Phase 5: 打包与分发
├── 任务 5.1: 创建 PyInstaller 构建脚本
├── 任务 5.2: 创建 Inno Setup 安装脚本
├── 任务 5.3: 创建一键构建脚本
└── 任务 5.4: 创建安装说明文档
    ↓
Phase 6: 测试与验证
├── 任务 6.1: 功能测试
├── 任务 6.2: 兼容性测试
├── 任务 6.3: 性能优化
└── 任务 6.4: 最终验证
```

---

## 交付物清单

### 代码文件
- [ ] `gui/__init__.py`
- [ ] `gui/main_window.py`
- [ ] `gui/widgets/` 下所有组件
- [ ] `gui/dialogs/` 下所有对话框
- [ ] `gui/utils/` 下所有工具类

### 构建脚本
- [ ] `build/build_exe.py`
- [ ] `build/setup.iss`
- [ ] `build.py` (一键构建)

### 资源文件
- [ ] `build/assets/icon.ico`
- [ ] `build/assets/banner.bmp`

### 文档
- [ ] `docs/INSTALL.md`
- [ ] `README_GUI.md` (GUI 版本说明)

### 输出文件
- [ ] `dist/PPT-Translator-Setup.exe` (最终安装包)

---

*本文档由 PPT Translator GUI 项目团队维护*
*最后更新: 2026-02-14*
*版本: v1.0.0*
