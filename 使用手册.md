# PPT Translator 使用手册

## 目录

- [简介](#简介)
- [功能特性](#功能特性)
- [系统要求](#系统要求)
- [快速开始](#快速开始)
- [GUI 界面使用指南](#gui-界面使用指南)
- [命令行使用指南](#命令行使用指南)
- [API 配置](#api-配置)
- [打包发布](#打包发布)
- [常见问题](#常见问题)

---

## 简介

PPT Translator 是一款专业的 PowerPoint 翻译工具，能够在保持原始格式的前提下，将演示文稿翻译成多种语言。它支持多种主流的 AI 模型提供商，包括 DeepSeek、GLM、Gemini、OpenAI、Anthropic 和 Grok。

---

## 功能特性

### ✨ 核心功能
- **格式保持**：完美保留字体、颜色、间距、表格和对齐方式
- **多提供商支持**：DeepSeek、GLM、Gemini、OpenAI、Anthropic、Grok
- **多模型选择**：每个提供商都支持多种模型版本
- **智能缓存**：避免重复翻译相同内容，节省 API 成本
- **批量处理**：支持翻译整个目录的演示文稿
- **后台处理**：GUI 界面支持后台处理，不会卡顿

### 🎨 GUI 界面特性
- **极简设计风格**：高级杂志风格的简洁界面
- **直观操作**：无需命令行知识，傻瓜式操作
- **实时日志**：显示翻译进度和状态
- **API 密钥安全**：密码输入框保护您的密钥

---

## 系统要求

### 软件要求
- **操作系统**：Windows 10/11、macOS 10.14+、Linux
- **Python 版本**：Python 3.10 或更高版本
- **内存**：建议 4GB 及以上

### 硬件要求
- **CPU**：双核及以上
- **硬盘空间**：至少 500MB 可用空间

---

## 快速开始

### 方式一：使用 GUI 界面（推荐）

1. **安装依赖**
   ```bash
   python -m venv .venv
   .venv\Scripts\activate  # Windows
   source .venv/bin/activate  # macOS/Linux
   pip install -r requirements.txt
   ```

2. **启动 GUI**
   ```bash
   python main_gui.py
   ```

3. **在界面中配置并开始翻译**

### 方式二：使用命令行

1. **安装依赖**
   ```bash
   python -m venv .venv
   .venv\Scripts\activate  # Windows
   source .venv/bin/activate  # macOS/Linux
   pip install -r requirements.txt
   ```

2. **配置 API 密钥**
   ```bash
   cp example.env .env
   # 编辑 .env 文件，填入您的 API 密钥
   ```

3. **运行翻译**
   ```bash
   python main.py "您的演示文稿.pptx" --provider deepseek --source-lang en --target-lang zh
   ```

---

## GUI 界面使用指南

### 界面布局说明

GUI 界面分为以下几个部分：

1. **标题区域**：显示应用程序名称和副标题
2. **配置区域**：
   - 模型供应商选择
   - 模型选择
   - API 密钥输入
3. **文件区域**：
   - 输入文件选择
   - 输出文件选择
4. **语言区域**：
   - 源语言选择
   - 目标语言选择
5. **翻译按钮**：开始翻译的按钮
6. **日志区域**：显示翻译过程的实时日志

### 详细操作步骤

#### 1. 选择模型供应商

点击"Model Provider"下拉菜单，选择您要使用的 AI 模型提供商：

- **DeepSeek**：支持 `deepseek-chat`、`deepseek-reasoner`
- **GLM**：支持 `glm-5`、`glm-4.7`
- **Gemini**：支持 `gemini-3-pro`、`gemini-3-flash`

#### 2. 选择模型

选择模型供应商后，"Model"下拉菜单会自动更新为该供应商支持的模型列表。

#### 3. 输入 API 密钥

在"API Key"输入框中输入您的 API 密钥。输入内容会以密码形式显示，保护您的密钥安全。

#### 4. 选择输入文件

- 点击"Input File"右侧的"Browse"按钮
- 在弹出的文件选择对话框中选择您要翻译的 PowerPoint 文件（支持 .ppt 和 .pptx 格式）
- 选择文件后，"Output File"会自动生成一个默认的输出文件名

#### 5. （可选）修改输出文件

如果需要自定义输出文件名和路径：
- 点击"Output File"右侧的"Browse"按钮
- 在弹出的保存对话框中选择保存位置并输入文件名

#### 6. 选择语言

- **Source**：选择演示文稿的原始语言
- **Target**：选择要翻译成的目标语言

支持的语言：
- 英语 (en)
- 简体中文 (zh)
- 繁體中文 (zh-TW)
- 西班牙语 (es)
- 法语 (fr)
- 德语 (de)
- 日语 (ja)
- 韩语 (ko)

#### 7. 开始翻译

点击"Translate"按钮开始翻译：
- 按钮会变为禁用状态，防止重复点击
- 日志区域会实时显示翻译进度
- 翻译完成后会显示输出文件路径

#### 8. 查看翻译结果

翻译完成后，您可以在指定的输出路径找到翻译好的演示文稿文件。

---

## 命令行使用指南

### 基本用法

```bash
python main.py <文件或目录路径> [选项]
```

### 常用选项

| 选项 | 说明 | 默认值 |
|------|------|--------|
| `--source-lang` | 源语言代码 | zh |
| `--target-lang` | 目标语言代码 | en |
| `--provider` | 模型供应商 | openai |
| `--model` | 模型名称 | 各供应商默认模型 |
| `--max-chunk-size` | 每次翻译请求的最大字符数 | 1000 |
| `--max-workers` | 并行处理的线程数 | 4 |
| `--keep-intermediate` | 保留中间 XML 文件 | False |

### 可用的模型供应商

| 供应商 | 可用模型 | 默认模型 | 环境变量 |
|--------|----------|----------|----------|
| deepseek | deepseek-chat, deepseek-reasoner | deepseek-chat | DEEPSEEK_API_KEY |
| glm | glm-5, glm-4.7 | glm-5 | GLM_API_KEY |
| gemini | gemini-3-pro, gemini-3-flash | gemini-3-flash | GOOGLE_API_KEY |
| openai | gpt-5.2-2025-12-11 等 | gpt-5.2-2025-12-11 | OPENAI_API_KEY |
| anthropic | claude-sonnet-4-5-20250514 等 | claude-sonnet-4-5-20250514 | ANTHROPIC_API_KEY |
| grok | grok-4.1-fast 等 | grok-4.1-fast | GROK_API_KEY |

### 使用示例

#### 示例 1：翻译单个文件（DeepSeek）
```bash
python main.py "演示文稿.pptx" \
  --provider deepseek \
  --model deepseek-chat \
  --source-lang en \
  --target-lang zh
```

#### 示例 2：翻译整个目录（GLM）
```bash
python main.py "/path/to/presentations" \
  --provider glm \
  --model glm-5 \
  --source-lang zh \
  --target-lang en \
  --max-workers 8
```

#### 示例 3：翻译并保留中间文件（Gemini）
```bash
python main.py "演示文稿.pptx" \
  --provider gemini \
  --model gemini-3-pro \
  --source-lang en \
  --target-lang zh \
  --keep-intermediate
```

### 输出文件

翻译完成后会生成以下文件：
- `{文件名}_original.xml` - 原始内容（如果使用 `--keep-intermediate`）
- `{文件名}_translated.xml` - 翻译内容（如果使用 `--keep-intermediate`）
- `{文件名}_translated.pptx` - 最终的翻译演示文稿

---

## API 配置

### 获取 API 密钥

#### DeepSeek
1. 访问 [DeepSeek 官网](https://platform.deepseek.com/)
2. 注册账号并登录
3. 进入 API 管理页面创建 API Key

#### GLM (智谱 AI)
1. 访问 [智谱 AI 开放平台](https://open.bigmodel.cn/)
2. 注册账号并登录
3. 进入 API Key 管理页面创建新的 API Key

#### Gemini (Google)
1. 访问 [Google AI Studio](https://aistudio.google.com/)
2. 登录 Google 账号
3. 创建 API Key

#### OpenAI
1. 访问 [OpenAI 官网](https://platform.openai.com/)
2. 注册账号并登录
3. 进入 API Keys 页面创建新的 API Key

#### Anthropic
1. 访问 [Anthropic 官网](https://console.anthropic.com/)
2. 注册账号并登录
3. 进入 API Keys 页面创建新的 API Key

### 配置环境变量

#### 方式一：使用 .env 文件（推荐）

1. 复制示例文件：
   ```bash
   cp example.env .env
   ```

2. 编辑 `.env` 文件，填入您的 API 密钥：
   ```
   # DeepSeek 配置
   DEEPSEEK_API_KEY=your_deepseek_api_key_here
   
   # GLM 配置
   GLM_API_KEY=your_glm_api_key_here
   
   # Gemini 配置
   GOOGLE_API_KEY=your_google_api_key_here
   
   # 其他提供商...
   ```

#### 方式二：临时设置环境变量

**Windows PowerShell:**
```powershell
$env:DEEPSEEK_API_KEY="your_api_key"
```

**Windows CMD:**
```cmd
set DEEPSEEK_API_KEY=your_api_key
```

**macOS/Linux:**
```bash
export DEEPSEEK_API_KEY=your_api_key
```

---

## 打包发布

### 打包为可执行文件

您可以将工具打包为独立的可执行文件，用户无需安装 Python 即可使用。

#### Windows 打包

1. 双击运行 `build.bat`，或在命令行中执行：
   ```bash
   build.bat
   ```

2. 等待打包完成，可执行文件位于 `dist` 目录中：
   ```
   dist/PPT Translator.exe
   ```

#### macOS/Linux 打包

1. 赋予脚本执行权限：
   ```bash
   chmod +x build.sh
   ```

2. 运行打包脚本：
   ```bash
   ./build.sh
   ```

3. 可执行文件位于 `dist` 目录中。

### 手动打包步骤

如果需要自定义打包过程，可以按以下步骤操作：

1. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

2. 使用 PyInstaller 打包：
   ```bash
   pyinstaller --clean build.spec
   ```

3. 打包完成后，可执行文件位于 `dist` 目录。

### 分发给用户

将 `dist` 目录中的可执行文件分发给用户：
- Windows 用户：`PPT Translator.exe`
- 用户双击即可运行，无需安装 Python 或任何依赖

---

## 常见问题

### Q1: 翻译时提示缺少 API 密钥怎么办？

**A:** 请确保您：
1. 已获取对应的 API 密钥
2. 已在 `.env` 文件或环境变量中配置了密钥
3. 如果使用 GUI，确保在界面中正确输入了 API 密钥

### Q2: 翻译后的文件格式错乱怎么办？

**A:** 这通常是由于字体不兼容造成的。建议：
1. 确保目标系统上安装了与源文件相同的字体
2. 如果使用特殊字体，建议在翻译前将文字转换为通用字体（如 Arial、Microsoft YaHei）

### Q3: 如何提高翻译质量？

**A:** 可以尝试：
1. 使用更高质量的模型（如 deepseek-reasoner、gemini-3-pro）
2. 减小 `--max-chunk-size` 的值，让每个请求处理更少的内容
3. 确保源文件的文字清晰、格式规范

### Q4: 可以批量翻译多个文件吗？

**A:** 可以！有两种方式：
1. **命令行方式**：直接指定目录路径
2. **GUI 方式**：目前 GUI 只支持单个文件，如需批量请使用命令行

### Q5: 翻译过程中断了怎么办？

**A:** 重新运行翻译即可。工具会重新开始处理，不会影响源文件。

### Q6: 支持哪些 PowerPoint 格式？

**A:** 支持：
- `.pptx` - PowerPoint 2007 及以上版本
- `.ppt` - PowerPoint 97-2003 版本（可能部分格式不支持）

### Q7: 如何自定义系统提示词？

**A:** 您可以编辑 `ppt_translator/providers/base.py` 文件中的 `build_messages` 方法，修改 `system_prompt` 变量的内容。

### Q8: 打包后的可执行文件太大怎么办？

**A:** 可以尝试：
1. 在 `build.spec` 中添加更多的 `excludes` 来排除不需要的模块
2. 使用 UPX 压缩（已在配置中启用）
3. 考虑只打包 CLI 版本而不是 GUI 版本

### Q9: 使用过程中遇到错误怎么办？

**A:** 请：
1. 查看日志输出中的错误信息
2. 确认 API 密钥有效且有足够的额度
3. 检查网络连接是否正常
4. 如果问题持续，可以在 GitHub 上提交 Issue

### Q10: 这个工具收费吗？

**A:** 工具本身是免费开源的，但使用 AI 模型提供商的 API 可能会产生费用。请参考各提供商的定价页面了解详情。

---

## 技术支持

如果您在使用过程中遇到问题：
1. 查看本文档的"常见问题"部分
2. 访问项目的 GitHub 仓库查看 Issue 和 Discussion
3. 提交新的 Issue 描述您的问题

---

## 许可证

本项目采用 MIT 许可证。详见项目根目录的 LICENSE 文件。

---

**祝您使用愉快！** 🎉
